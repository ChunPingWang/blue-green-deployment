# 任務清單：測試腳本與專案文件

**輸入**: 設計文件來自 `/specs/002-test-script-readme/`
**前置條件**: plan.md (必要), spec.md (必要), research.md, data-model.md

**測試**: 本功能規格書未明確要求自動化測試，因此採用手動整合測試驗證。

**組織方式**: 任務按使用者故事分組，以便獨立實作和測試每個故事。

## 格式: `[ID] [P?] [Story] 描述`

- **[P]**: 可平行執行（不同檔案、無相依性）
- **[Story]**: 所屬使用者故事（例如 US1, US2, US3）
- 描述中包含確切的檔案路徑

## 路徑慣例

- **腳本目錄**: `scripts/`
- **文件**: `README.md`（專案根目錄）

---

## Phase 1: 設定（共用基礎設施）

**目的**: 專案初始化和基本結構

- [ ] T001 建立 scripts/ 目錄結構
- [ ] T002 建立測試腳本骨架檔案 scripts/test-traffic.sh

**檢查點**: 目錄結構已就緒

---

## Phase 2: 基礎建設（阻擋性前置條件）

**目的**: 測試腳本的核心功能，必須在所有使用者故事實作前完成

**⚠️ 重要**: 使用者故事工作需等此階段完成才能開始

- [ ] T003 實作腳本標頭與使用說明函式 scripts/test-traffic.sh
- [ ] T004 實作參數驗證邏輯（檢查請求次數為正整數）scripts/test-traffic.sh
- [ ] T005 實作 curl 可用性檢查 scripts/test-traffic.sh
- [ ] T006 實作閘道連線測試函式 scripts/test-traffic.sh

**檢查點**: 基礎架構已就緒，使用者故事實作可開始

---

## Phase 3: 使用者故事 1 - 執行流量測試腳本 (優先級: P1) 🎯 MVP

**目標**: 使用者能夠執行測試腳本，自動發送請求並顯示藍綠服務的流量分配統計

**獨立測試**: 執行 `./scripts/test-traffic.sh` 並觀察輸出，確認能正確統計並顯示來自不同服務的回應次數和比例

### 實作任務

- [ ] T007 [US1] 實作請求迴圈與回應收集邏輯 scripts/test-traffic.sh
- [ ] T008 [US1] 實作回應來源判斷（Blue/Green/Unknown）scripts/test-traffic.sh
- [ ] T009 [US1] 實作統計計算邏輯（計數與百分比）scripts/test-traffic.sh
- [ ] T010 [US1] 實作進度指示器（執行中進度條）scripts/test-traffic.sh
- [ ] T011 [US1] 實作統計報告輸出格式 scripts/test-traffic.sh
- [ ] T012 [US1] 實作執行時間計算與顯示 scripts/test-traffic.sh
- [ ] T013 [US1] 實作錯誤處理（閘道未啟動、請求失敗）scripts/test-traffic.sh
- [ ] T014 [US1] 新增腳本執行權限並測試完整流程 scripts/test-traffic.sh

**檢查點**: 使用者故事 1 應可完整獨立運作與測試

---

## Phase 4: 使用者故事 2 - 閱讀專案說明文件 (優先級: P2)

**目標**: 使用者能夠閱讀 README 文件，了解專案目的、如何啟動服務、如何執行測試

**獨立測試**: 讓一個不熟悉專案的人閱讀 README 並按照指示操作，驗證文件的完整性和清晰度

### 實作任務

- [ ] T015 [US2] 撰寫專案標題與簡介章節 README.md
- [ ] T016 [US2] 撰寫前置需求章節（執行環境要求）README.md
- [ ] T017 [US2] 撰寫快速開始章節（服務啟動步驟）README.md
- [ ] T018 [US2] 撰寫測試腳本使用說明章節 README.md

**檢查點**: 使用者故事 2 應可完整獨立運作與測試

---

## Phase 5: 使用者故事 3 - 了解專案架構 (優先級: P3)

**目標**: 使用者能夠透過 README 理解三個微服務之間的關係和流量分配原理

**獨立測試**: 閱讀架構說明部分，驗證是否清楚解釋了閘道和兩個後端服務的關係

### 實作任務

- [ ] T019 [US3] 撰寫架構說明章節（含 ASCII 圖）README.md
- [ ] T020 [US3] 新增 Mermaid 架構圖 README.md
- [ ] T021 [US3] 撰寫專案結構說明章節 README.md

**檢查點**: 使用者故事 3 應可完整獨立運作與測試

---

## Phase 6: 收尾與跨功能關注點

**目的**: 影響多個使用者故事的改進項目

- [ ] T022 [P] 執行 quickstart.md 驗證流程
- [ ] T023 檢查所有輸出訊息的繁體中文一致性
- [ ] T024 最終整合測試（完整執行腳本並驗證 README 說明）

---

## 相依性與執行順序

### 階段相依性

- **設定（Phase 1）**: 無相依性，可立即開始
- **基礎建設（Phase 2）**: 相依於設定完成，**阻擋**所有使用者故事
- **使用者故事（Phase 3+）**: 全部相依於基礎建設階段完成
  - 使用者故事可平行進行（若有人力）
  - 或依優先級順序執行（P1 → P2 → P3）
- **收尾（最終階段）**: 相依於所有預期的使用者故事完成

### 使用者故事相依性

- **使用者故事 1 (P1)**: 可在基礎建設（Phase 2）後開始，不相依其他故事
- **使用者故事 2 (P2)**: 可在基礎建設後開始，但「測試腳本使用說明」章節需參考 US1 完成的腳本
- **使用者故事 3 (P3)**: 可在基礎建設後開始，不相依其他故事

### 各使用者故事內部

- 腳本任務按邏輯順序執行（骨架 → 核心邏輯 → 輸出格式 → 錯誤處理）
- README 章節可平行撰寫（不同章節）
- 故事完成後再進入下一優先級

### 平行執行機會

- Phase 1 所有任務可平行執行
- Phase 2 標記 [P] 的任務可平行執行
- Phase 4、5 中不同章節的 README 任務可平行撰寫
- 不同使用者故事可由不同人員平行處理

---

## 平行執行範例

```bash
# Phase 4 README 章節可平行撰寫：
任務: "撰寫專案標題與簡介章節 README.md"
任務: "撰寫前置需求章節 README.md"

# Phase 5 架構相關任務可平行：
任務: "撰寫架構說明章節（含 ASCII 圖）README.md"
任務: "撰寫專案結構說明章節 README.md"
```

---

## 實作策略

### MVP 優先（僅使用者故事 1）

1. 完成 Phase 1: 設定
2. 完成 Phase 2: 基礎建設（重要：阻擋所有故事）
3. 完成 Phase 3: 使用者故事 1
4. **停止並驗證**: 獨立測試使用者故事 1
5. 可展示/部署 MVP

### 增量交付

1. 完成 設定 + 基礎建設 → 基礎架構就緒
2. 新增使用者故事 1 → 獨立測試 → 可展示（MVP！）
3. 新增使用者故事 2 → 獨立測試 → 可展示
4. 新增使用者故事 3 → 獨立測試 → 可展示
5. 每個故事新增價值，不破壞之前的故事

---

## 備註

- [P] 任務 = 不同檔案、無相依性
- [Story] 標籤對應特定使用者故事以便追蹤
- 每個使用者故事應可獨立完成與測試
- 每個任務或邏輯群組完成後提交
- 可在任何檢查點停止以獨立驗證故事
- 避免：模糊任務、同檔案衝突、破壞獨立性的跨故事相依
